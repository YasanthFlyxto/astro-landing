---
import { ViewTransitions } from "astro:transitions";
import Footer from "../components/Footer.astro";

interface Props {
  title: string;
}

const { title } = Astro.props;
---

<html class="h-full bg-[#FAFCFF]" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Dashboard template" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/logo-64x64.png" />
    <meta name="generator" content="Dashboard" />
    <title>{title}</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@200;400&family=Roboto:wght@100&display=swap"
      rel="stylesheet"
    />
    <ViewTransitions />
  </head>
  <body class="h-full font-nunito">
    <div class="bg-[#FAFCFF]">
      <!-- Header -->
      <header
        class="fixed top-0 left-0 right-0 z-40 transition-all duration-300 ease-in-out h-20 md:h-24 bg-[#FAFCFF]/80"
        id="header"
      >
        <nav class="z-10 w-full backdrop-blur-lg px-4 sm:px-6 lg:px-8 h-full">
          <div
            class="flex items-center justify-between h-full max-w-7xl mx-auto"
          >
            <!-- Logo -->
            <div class="z-20 flex items-center">
              <a href="/" aria-label="logo" class="flex items-center">
                <img
                  src="https://www.flystudios.lk/wp-content/uploads/2023/08/rsz_1white_fly_logo_-_copy-edited.png"
                  width={80}
                  height={128}
                  alt=""
                  class="w-[70px] md:w-[90px] invert"
                />
              </a>
            </div>

            <!-- Navigation menu for desktop -->
            <div class="hidden lg:flex text-md pl-16 items-center space-x-8">
              <a
                href="/"
                class="font-medium text-gray-600 hover:text-blue-400 transition"
                >Home</a
              >
              <a
                href="/portfolio"
                class="font-medium text-gray-600 hover:text-blue-400 transition"
                >Portfolio</a
              >
              <a
                href="/company"
                class="font-medium text-gray-600 hover:text-blue-400 transition"
                >Company</a
              >
              <a
                href="/contact"
                class="font-medium text-gray-600 hover:text-blue-400 transition"
                >Contact</a
              >
            </div>

            <!-- WhatsApp button for desktop -->
            <div class="hidden lg:block">
              <a
                href="https://wa.link/0k2oeq"
                class="relative ring-1 rounded-full bg-white/80 hover:ring-green-500 flex h-8 items-center justify-center px-4 before:absolute before:inset-0 before:rounded-full before:transition before:duration-300 hover:before:scale-105 active:duration-75 active:before:scale-95 sm:w-max text-blue-900 hover:text-green-500"
                target="_blank"
              >
                <span class="relative text-sm font-semibold transition"
                  >Chat on WhatsApp &#10148;</span
                >
              </a>
            </div>

            <!-- Mobile menu button -->
            <div class="lg:hidden">
              <button
                id="openNavBar"
                aria-label="Open Menu"
                class="p-2 transition duration-200 z-50 rounded focus:outline-none focus:shadow-outline"
              >
                <svg
                  class="w-6 h-6"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <line x1="3" y1="12" x2="21" y2="12"></line>
                  <line x1="3" y1="6" x2="21" y2="6"></line>
                  <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
              </button>
            </div>
          </div>
        </nav>

        <!-- Mobile Navigation Menu -->
         
        <div
          id="navMenu"
          class="lg:hidden fixed inset-0 bg-white z-40 flex flex-col items-center justify-center space-y-8 invisible opacity-0 transition-all duration-300"
        >
        
        <button
        id="closeNavBar"
        aria-label="Open Menu"
        class="p-2 transition duration-200 z-50 absolute top-5 right-5 rounded focus:outline-none focus:shadow-outline"
      >
        <svg
          class="w-6 h-6"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
          <div class="flex flex-col items-center bg-blue-900 py-24 px-24 rounded-2xl space-y-6 absolute top-12">
            <a
              href="/"
              class="text-xl font-medium text-gray-200 hover:text-blue-400 transition"
              >Home</a
            >
            <a
              href="/portfolio"
              class="text-xl font-medium text-gray-200 hover:text-blue-400 transition"
              >Portfolio</a
            >
            <a
              href="/company"
              class="text-xl font-medium text-gray-200 hover:text-blue-400 transition"
              >Company</a
            >
            <a
              href="/contact"
              class="text-xl font-medium text-gray-200 hover:text-blue-400 transition"
              >Contact</a
            >
            <a
              href="https://wa.link/0k2oeq"
              class="relative ring-1 rounded-full hover:ring-green-500 flex h-10 items-center justify-center px-6 before:absolute before:inset-0 before:rounded-full before:transition before:duration-300 hover:before:scale-105 active:duration-75 active:before:scale-95"
              target="_blank"
            >
              <span
                class="relative text-base font-semibold transition hover:text-green-500 text-blue-200"
                >Chat on WhatsApp</span
              >
            </a>
          </div>
        </div>
      </header>

      <main class="isolate pt-20 md:pt-24" id="main-content">
        <slot />
      </main>

      <!-- Footer -->
      <div class="mx-auto mt-32 max-w-7xl px-6 lg:px-8">
        <Footer />
      </div>
    </div>
  </body>
</html>

<script>
  function setupNavbar() {
    const header = document.getElementById("header");
    const navMenu = document.getElementById("navMenu");
    const openNavBar = document.getElementById("openNavBar");
    const closeNavBar = document.getElementById("closeNavBar");
    const mainContent = document.getElementById("main-content");

    function toggleMenu() {
      navMenu.classList.toggle("invisible");
      navMenu.classList.toggle("opacity-0");
      document.body.classList.toggle("overflow-hidden");
      mainContent.classList.toggle("blur-lg bg-white");

      // Reset the header position when opening the menu
      if (!navMenu.classList.contains("invisible")) {
        header.style.transform = "translateY(0)";
      }
    }

    openNavBar.addEventListener("click", toggleMenu);
    closeNavBar.addEventListener("click", toggleMenu);

    // Close menu when clicking outside
    navMenu.addEventListener("click", (e) => {
      if (e.target === navMenu) {
        toggleMenu();
      }
    });

    // Close menu when pressing Escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && !navMenu.classList.contains("invisible")) {
        toggleMenu();
      }
    });

    // Handle resize events
    function handleResize() {
      if (window.innerWidth >= 1024) {
        navMenu.classList.add("invisible", "opacity-0");
        document.body.classList.remove("overflow-hidden");
        mainContent.classList.remove("blur-sm");
      }
    }

    window.addEventListener("resize", handleResize);

    // Initial setup
    handleResize();
  }

  function setupScrollBehavior() {
    const header = document.getElementById("header");
    const navMenu = document.getElementById("navMenu");
    let lastScrollTop = 0;
    let ticking = false;

    function handleScroll() {
      const scrollTop =
        window.pageYOffset || document.documentElement.scrollTop;

      if (!ticking) {
        window.requestAnimationFrame(() => {
          if (scrollTop > lastScrollTop && scrollTop > 100) {
            // Scrolling down
            header.style.transform = "translateY(-100%)";
          } else {
            // Scrolling up
            header.style.transform = "translateY(0)";
          }
          lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
          ticking = false;
        });

        ticking = true;
      }

      // Ensure the mobile menu stays in view when open
      if (!navMenu.classList.contains("invisible")) {
        header.style.transform = "translateY(0)";
      }
    }

    window.addEventListener("scroll", handleScroll, { passive: true });
  }

  // Run setup on initial load
  document.addEventListener("DOMContentLoaded", () => {
    setupNavbar();
    setupScrollBehavior();
  });

  // Re-run setup on view transitions
  document.addEventListener("astro:after-swap", () => {
    setupNavbar();
    setupScrollBehavior();
  });
</script>

<style>
  /* Ensure the mobile menu is always visible when open */
  #navMenu:not(.invisible) {
    top: 0 !important;
  }
</style>
